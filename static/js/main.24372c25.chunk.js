(this["webpackJsonpnews-explorer-frontend"]=this["webpackJsonpnews-explorer-frontend"]||[]).push([[0],{31:function(e,t,r){},38:function(e,t,r){"use strict";r.r(t);var n=r(0),a=r(1),s=r.n(a),c=r(22),o=r.n(c),i=(r(31),function(e){e&&e instanceof Function&&r.e(3).then(r.bind(null,39)).then((function(t){var r=t.getCLS,n=t.getFID,a=t.getFCP,s=t.getLCP,c=t.getTTFB;r(e),n(e),a(e),s(e),c(e)}))}),l=r(5),u=r.n(l),d=r(10),p=r(2),h=r(9),b=r(3),j=s.a.createContext(),g=function(e){return Object(n.jsxs)("div",{className:"navbar ".concat(e.isNavOpen?"navbar_active":""),children:[Object(n.jsx)(h.c,{to:"/",exact:!0,activeClassName:"navbar__link_active",className:"navbar__link ".concat(e.navigationLinkColors("navbar__link_dark")),children:"Home"}),e.isLoggedIn?Object(n.jsx)(h.c,{to:"/saved-news",exact:!0,activeClassName:"navbar__link_active_dark",className:"navbar__link ".concat(e.navigationLinkColors("navbar__link_dark")),children:"Saved articles"}):void 0]})},f=function(e){var t=e.togglePopup,r=e.toggleFormPopup,s=e.signoutHandler,c=e.handlePopup,o=e.toggleNav,i=e.isNavOpen,l=Object(a.useContext)(j),u=Object(b.g)();function d(t){return e.isSavedNewsRoute&&!i?t:(e.isSavedNewsRoute,"")}return function(e){var t=Object(a.useRef)(!0);t.current&&e(),t.current=!1}((function(){u.location.state=null})),Object(a.useEffect)((function(){null!==u.location.state&&void 0!==u.location.state&&u.location.state.redirected&&c()}),[u.location.state,c]),Object(n.jsx)("header",{className:"header ".concat(i?"header_nav-active":""),children:Object(n.jsxs)("div",{className:"header__size",children:[Object(n.jsx)("p",{className:"header__logo ".concat(d("header__logo_dark")," "),children:"NewsExplorer"}),Object(n.jsx)("button",{onClick:function(){e.isFormPopupOpen?(o(!1),t(!1),r(!1)):o(!i)},className:"header__icon ".concat(i?"header__icon_active":""," ").concat(e.isFormPopupOpen||e.isPopupOpen?"header__icon_active":""," ").concat(d("header__icon_dark"))}),Object(n.jsxs)("div",{className:"header__mobile-nav ".concat(i?"header__mobile-nav_visible":""),children:[Object(n.jsx)(g,{isLoggedIn:e.isLoggedIn,isSavedNewsRoute:e.isSavedNewsRoute,isNavOpen:i,navigationLinkColors:d}),e.isLoggedIn?Object(n.jsx)("button",{onClick:function(){s().then((function(){e.toggleLoggedIn(!1),o(!1),localStorage.removeItem("articles"),localStorage.removeItem("token"),localStorage.removeItem("recent-search-keyword")})).catch((function(e){console.log(e)}))},className:"header__signout ".concat(d("header__signout_dark")),children:"".concat(i?"Sign out":l.name)}):Object(n.jsx)("button",{onClick:c,className:"header__signin ".concat(d("header__signin_dark")),children:"Sign in"})]})]})})},m=r.p+"static/media/footer__nav-icon_facebook.ce8865e2.svg",_=r.p+"static/media/footer__nav-icon_github.94b724e8.svg",O=function(){return Object(n.jsx)("footer",{className:"footer",children:Object(n.jsxs)("div",{className:"footer__width",children:[Object(n.jsx)("p",{className:"footer__copyright",children:"\xa9 Danny Gummow, Powered by News API"}),Object(n.jsxs)("nav",{className:"footer__navbar",children:[Object(n.jsxs)("div",{className:"footer__navlink-container",children:[Object(n.jsx)(h.b,{to:"/",className:"footer__navlink",children:"Home"}),Object(n.jsx)("a",{href:"https://practicum.yandex.com/",className:"footer__navlink",children:"Practicum by Yandex"})]}),Object(n.jsxs)("div",{className:"footer__nav-icon-container",children:[Object(n.jsx)("a",{href:"https://github.com/ddemosi/news-explorer-frontend",target:"_blank",rel:"noopener noreferrer",className:"footer__nav-icon footer__nav-icon_github",children:Object(n.jsx)("img",{alt:"Github logo",src:_})}),Object(n.jsx)("a",{href:"https://www.facebook.com/YPracticum/",target:"_blank",rel:"noopener noreferrer",className:"footer__nav-icon footer__nav-icon_facebook",children:Object(n.jsx)("img",{alt:"Facebook logo",src:m})})]})]})]})})},v="6a763a6b37bf49cf9315c6b0dc70547a",x={apiKey:v,url:"https://nomoreparties.co/news/v2",endpoint:"/everything",pageSize:100,auth:{Authorization:v},searchRange:7},w=function(e){var t=e.setCards,r=e.setVisibleCards,s=e.toggleIsLoading,c=e.isLoggedIn,o=e.getUserArticles,i=e.searchHandler,l=Object(a.useRef)(),u=Object(a.useState)(!1),d=Object(p.a)(u,2),h=d[0],b=d[1];function j(e){i(l.current.value).then((function(t){var r=[],n=[];if(!e)throw new Error("Saved articles retrieval failed");return 0===e.length?(t.articles.forEach((function(e){e.keyword=l.current.value,r.push(e)})),r):(e.forEach((function(e){n.push(e.url)})),t.articles.forEach((function(t){n.includes(t.url)&&(t.isSaved=!0,e.forEach((function(e){e.url===t.url&&(t._id=e._id)}))),t.keyword=l.current.value,r.push(t)})),r)})).then((function(e){if(e)return r(3),void t(e);throw s(!1),h(!1),new Error("Unhandled request error")})).then((function(){s(!1),b(!1)})).catch((function(e){b(!1),console.log(e)}))}function g(){if(b(!0),localStorage.setItem("recent-search-keyword",l.current.value),l.current.value.length>0)return s(!0),c?localStorage.getItem("articles")?void j(JSON.parse(localStorage.getItem("articles"))):void o().then((function(e){var t=[];return e.forEach((function(e){var r={_id:e._id,keyword:e.keyword,publishedAt:e.date,title:e.title,description:e.text,source:e.source,url:e.link,urlToImage:e.image};t.push(r)})),t})).then((function(e){localStorage.setItem("articles",JSON.stringify(e)),j(e)})).catch((function(e){console.log(e)})):void i(l.current.value).then((function(e){var t=[];return e.articles.forEach((function(e){e.keyword=l.current.value,t.push(e)})),t})).then((function(e){if(e)return r(3),void t(e);throw s(!1),new Error("Unhandled request error")})).then((function(){b(!1),s(!1)})).catch((function(e){console.log(e)}))}function f(e){e.preventDefault(),g()}return Object(a.useEffect)((function(){var e=localStorage.getItem("recent-search-keyword");if(e)return l.current.value=e,void g()}),[c]),Object(n.jsx)("section",{className:"search-container",children:Object(n.jsxs)("div",{className:"search-container__width",children:[Object(n.jsx)("h2",{className:"search-container__title",children:"What's going on in the world?"}),Object(n.jsx)("p",{className:"search-container__subtitle",children:"Find the latest news on any topic and save them in your personal account"}),Object(n.jsxs)("form",{onSubmit:f,className:"search-bar",children:[Object(n.jsx)("input",{ref:l,onKeyUp:function(e){e.preventDefault(),"Enter"===e.key&&f(e)},type:"text",placeholder:"Enter topic",className:"search-bar__input ".concat(h?"search-bar__input_disabled":""),disabled:h}),Object(n.jsx)("button",{type:"submit",className:"search-bar__button",children:"Search"})]})]})})},N=function(){return Object(n.jsx)("section",{className:"about",children:Object(n.jsxs)("div",{className:"about__width",children:[Object(n.jsx)("div",{className:"about__image"}),Object(n.jsxs)("div",{className:"about__text-container",children:[Object(n.jsx)("h2",{className:"about__title",children:"About the author"}),Object(n.jsx)("p",{className:"about__text",children:"Danny is an electronic music producer, mix engineer, and web developer from Salt Lake City, Utah. While his first love is making dance music, Danny loves to program web apps, especially using front end frameworks like Vue 3 and ReactJS."}),Object(n.jsx)("p",{className:"about__text",children:"Danny is currently pursuing a career in tech working part-time for Adobe Systems as a security contractor. He's also building his own company with his brother, Matt, that builds web apps that assists people that are trying to pursue full-time careers as freelancers."})]})]})})},k=function(e){var t=e._id,r=e.keyword,s=e.date,c=e.title,o=e.description,i=e.source,l=e.url,h=e.image,b=e.isSaved,j=e.isSavedNewsRoute,g=e.isLoggedIn,f=e.deleteArticleHandler,m=e.saveArticle,_=Object(a.useState)(!1),O=Object(p.a)(_,2),v=O[0],x=O[1],w=Object(a.useState)(""),N=Object(p.a)(w,2),k=N[0],y=N[1];function S(){return P.apply(this,arguments)}function P(){return(P=Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f(k);case 2:if(!e.sent){e.next=6;break}return x(!1),e.abrupt("return");case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function I(){return C.apply(this,arguments)}function C(){return(C=Object(d.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!v){e.next=5;break}return S(),e.abrupt("return");case 5:return e.next=7,m({keyword:r,title:c,text:o,date:s,source:i,link:l,image:h});case 7:if(!(t=e.sent)){e.next=14;break}return x(!0),y(t),e.abrupt("return");case 14:return x(!1),e.abrupt("return");case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(a.useEffect)((function(){b&&x(!0)}),[b,x]),Object(a.useEffect)((function(){y(t||null)}),[]),Object(n.jsxs)("li",{className:"news-card",children:[j&&g?Object(n.jsx)("button",{onClick:S,className:"news-card__delete-button",children:Object(n.jsx)("span",{className:"news-card__save-button-label",children:Object(n.jsx)("p",{children:"Remove from saved"})})}):!j&&g?Object(n.jsx)("button",{onClick:function(e){e.stopPropagation(),I()},className:"news-card__save-button ".concat(v?"news-card__save-button_active":"")}):Object(n.jsx)("button",{onClick:function(e){e.stopPropagation(),I()},className:"news-card__save-button",children:Object(n.jsx)("span",{className:"news-card__save-button-label",children:Object(n.jsx)("p",{children:"Sign in to save articles"})})}),Object(n.jsxs)("a",{className:"news-card__anchor",href:l,target:"_blank",rel:"noopener noreferrer",children:[function(){if(j)return Object(n.jsx)("div",{className:"news-card__keyword",children:Object(n.jsx)("p",{children:(e=r,"string"!==typeof e?"":e.charAt(0).toUpperCase()+e.slice(1))})});var e}(),Object(n.jsx)("div",{className:"news-card__image",style:{backgroundImage:"url(".concat(h,")")}}),Object(n.jsxs)("div",{className:"news-card__info-container",children:[Object(n.jsx)("p",{className:"news-card__date",children:j?s.substr(0,15):s.split("T")[0]}),Object(n.jsx)("h3",{className:"news-card__title",children:c}),Object(n.jsx)("p",{className:"news-card__snippet",children:o}),Object(n.jsx)("p",{className:"news-card__source",children:i})]})]})]})},y=function(e){var t=e.error;return Object(n.jsx)("div",{className:"nothing-found__container",children:Object(n.jsx)("h2",{className:"nothing-found__title",children:t?"Sorry, something went wrong during the request. There may be a connection issue or the server may be down. Please try again later":"Nothing Found"})})},S=function(e){var t=Object(a.useState)(!1),r=Object(p.a)(t,2),s=r[0],c=r[1];return Object(n.jsx)("section",{className:"news-card-list",children:Object(n.jsxs)("div",{className:"news-card-list__width",children:[e.isSavedNewsRoute?"":Object(n.jsx)("h2",{className:"news-card-list__title",children:"Search results"}),Object(n.jsx)("ul",{className:"news-card-list__container",children:0===e.cards.length?Object(n.jsx)(y,{error:!1}):e.cards?e.cards.slice(0,e.visibleCards).map((function(t){return Object(n.jsx)(k,{_id:t._id,keyword:t.keyword,date:t.publishedAt,title:t.title,description:t.description,source:t.source.name,url:t.url,image:t.urlToImage,isSaved:t.isSaved,isSavedNewsRoute:e.isSavedNewsRoute,isLoggedIn:e.isLoggedIn,deleteArticleHandler:e.deleteArticleHandler,saveArticle:e.saveArticle,togglePopup:e.togglePopup},t.url)})):Object(n.jsx)(y,{error:!0})}),e.isSavedNewsRoute||s?"":Object(n.jsx)("button",{onClick:function(){if(e.visibleCards>100)c(!0);else{var t=e.visibleCards+3;e.setVisibleCards(t)}},className:"news-card-list__show-more",children:"Show more"})]})})},P=function(){return Object(n.jsx)("div",{className:"circle-preloader__container",children:Object(n.jsx)("i",{className:"circle-preloader"})})},I=function(e){var t=e.isLoggedIn,r=e.isLoading,s=e.toggleIsLoading,c=e.handlePopup,o=e.addArticleHandler,i=e.getUserArticles,l=e.searchHandler,h=e.deleteArticleHandler,b=Object(a.useState)([]),j=Object(p.a)(b,2),g=j[0],f=j[1],m=Object(a.useState)(0),_=Object(p.a)(m,2),O=_[0],v=_[1];function x(e){return k.apply(this,arguments)}function k(){return(k=Object(d.a)(u.a.mark((function e(r){var n,a,s,i,l,d,p;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.keyword,a=r.title,s=r.text,i=r.date,l=r.source,d=r.link,p=r.image,t){e.next=4;break}return c(),e.abrupt("return",!1);case 4:return e.abrupt("return",o({keyword:n,title:a,text:s,date:i,source:l,link:d,image:p}).then((function(e){return!!e&&(localStorage.removeItem("articles"),e._id)})).catch((function(e){console.log(e)})));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(n.jsxs)("div",{className:"main",children:[Object(n.jsx)(w,{setCards:f,setVisibleCards:v,toggleIsLoading:s,isLoggedIn:t,getUserArticles:i,searchHandler:l}),function(){if(r)return Object(n.jsx)(P,{});if(!r&&O>0){if(!g)return Object(n.jsx)(y,{error:!0});if(0===g.length)return Object(n.jsx)(y,{error:!1});if(g)return Object(n.jsx)(S,{isSavedNewsRoute:!1,isLoggedIn:t,cards:g,setCards:f,visibleCards:O,setVisibleCards:v,saveArticle:x,deleteArticleHandler:h})}}(),Object(n.jsx)(N,{})]})},C=r(24),R=r(16),L=function(e){var t=e.savedCards,r=e.sortedKeywords,s=Object(a.useContext)(j),c=function(e){return"string"!==typeof e?"":e.charAt(0).toUpperCase()+e.slice(1)};return Object(n.jsx)("section",{className:"saved-news-header",children:Object(n.jsxs)("div",{className:"saved-news-header__width",children:[Object(n.jsx)("p",{className:"saved-news-header__label",children:"Saved articles"}),Object(n.jsxs)("h2",{className:"saved-news-header__title",children:[s.name,", you have ",t&&t.length>0?t.length:"no"," saved articles"]}),r&&r.length>0?Object(n.jsxs)("p",{className:"saved-news-header__keyword-text",children:["By keywords: ",Object(n.jsx)("span",{className:"saved-news-header__keywords",children:1===r.length?"".concat(c(r[0])):2===r.length?"".concat(c(r[0])," and ").concat(c(r[1])):3===r.length?"".concat(c(r[0]),", ").concat(c(r[1]),", and ").concat(c(r[2])):"".concat(c(r[0]),", ").concat(c(r[1]),", and ").concat(r.length-2," others")})]}):""]})})},A=function(e){var t=e.isLoading,r=e.toggleIsLoading,s=e.isLoggedIn,c=e.deleteArticleHandler,o=e.getUserArticles,i=Object(a.useState)(),l=Object(p.a)(i,2),u=l[0],d=l[1],h=Object(a.useState)([]),b=Object(p.a)(h,2),j=b[0],g=b[1];function f(e){e&&c(e).then((function(){_()})).catch((function(e){console.log(e)}))}var m=function(e){if(e){var t=function(){var t=[];e.forEach((function(e){var r=e.keyword.toLowerCase();t.push(r)}));for(var r={},n=0;n<t.length;++n)r[t[n]]||(r[t[n]]=0),++r[t[n]];for(var a=Object(R.a)({},r),s=[],c=0;c<Object.keys(r).length;++c){var o=Object.keys(a).reduce((function(e,t){return a[e]>a[t]?e:t}));s.push(o),delete a[o]}return{v:s}}();return"object"===typeof t?t.v:void 0}};var _=Object(a.useCallback)((function(){r(!0);var e=JSON.parse(localStorage.getItem("articles"));if(e){var t=m(e);g(t),d(e),r(!1)}else o().then((function(e){var t=[];return e.forEach((function(e){var r={_id:e._id,keyword:e.keyword,publishedAt:e.date,title:e.title,description:e.text,source:e.source,url:e.link,urlToImage:e.image};t.push(r)})),t})).then((function(e){var t=m(e);return g(t),function(e,t){var r,n={},a=Object(C.a)(e.entries());try{for(a.s();!(r=a.n()).done;){var s=Object(p.a)(r.value,2),c=s[0],o=s[1];n[o]=c}}catch(i){a.e(i)}finally{a.f()}return t.sort((function(e,t){return n[e.keyword]-n[t.keyword]})),t}(t,e)})).then((function(e){localStorage.setItem("articles",JSON.stringify(e)),d(e),r(!1)})).catch((function(e){console.log(e)}))}),[r,o]);return Object(a.useEffect)((function(){_()}),[_]),Object(n.jsxs)("section",{className:"saved-news",children:[Object(n.jsx)(L,{savedCards:u,sortedKeywords:j}),function(){if(!u)return Object(n.jsx)(y,{error:!0});if(t)return Object(n.jsx)(P,{});if(!t){if(0===u.length)return Object(n.jsx)(y,{error:!1});if(u)return Object(n.jsx)(S,{isSavedNewsRoute:!0,isLoggedIn:s,cards:u,setCards:d,visibleCards:u.length,setVisibleCards:null,deleteArticleHandler:f,sortedKeywords:j})}}()]})},F=function(e){var t=e.isRegisterPopup,r=e.toggleIsRegisterPopup,s=e.isFormPopupOpen,c=e.toggleFormPopup,o=e.toggleRegisterSuccessPopup,i=e.togglePopup,l=e.toggleLoggedIn,u=e.toggleRegisterSuccess,d=e.setCurrentUser,h=e.registerHandler,b=e.signinHandler,j=e.getUserInfo,g=Object(a.useState)({}),f=Object(p.a)(g,2),m=f[0],_=f[1],O=Object(a.useState)(!1),v=Object(p.a)(O,2),x=v[0],w=v[1],N=Object(a.useState)(!1),k=Object(p.a)(N,2),y=k[0],S=k[1],P=Object(a.useState)(!1),I=Object(p.a)(P,2),C=I[0],R=I[1],L=Object(a.useRef)(),A=Object(a.useRef)(),F=Object(a.useRef)();function E(e){e.preventDefault(),h(L.current.value,A.current.value,F.current.value).then((function(e){e?(u(!0),c(!1),o(!0)):(u(!1),c(!1),o(!0))})).catch((function(e){u(!1),c(!1),o(!0),console.log(e)}))}function U(e){e.preventDefault(),R(!0),b(L.current.value,A.current.value).then((function(e){e?(localStorage.setItem("token",e.token),j().then((function(e){d(e)})).then((function(){L.current.value="",A.current.value="",w(!1),R(!1),c(!1),l(!0),i(!1)})).catch((function(){w(!0),R(!1),S(!0)}))):(w(!0),R(!1),S(!0))})).catch((function(e){"Error: 400"===e?(w(!0),S(!0),R(!1)):(w(!0),R(!1),console.log(e))}))}function H(e){return/\S+@\S+\.\S+/.test(e)}function D(e){return/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[a-zA-Z\d\w\W]{8,}$/.test(e)}function T(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n={};return e&&H(e)||(n.email="Invalid email address"),t?D(t)||(n.password="Password must be at least 8 characters and contain a number and a capital letter."):n.password="Password is a required field",null===r||(r?r.length<5&&(n.username="Username must be at least 6 characters"):n.username="Username is a required field."),n}function q(){var e=T(L.current.value,A.current.value);0!==Object.keys(e).length?_(e):_(!1)}function J(){S(!1),r(!t)}return Object(n.jsx)(n.Fragment,{children:s?t?Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)("h2",{className:"popup__title",children:"Sign up"}),Object(n.jsxs)("form",{onChange:function(){return function(){var e=T(L.current.value,A.current.value,F.current.value);0!==Object.keys(e).length?_(e):_(!1)}()},onSubmit:E,className:"popup__form popup__form_register form",children:[Object(n.jsx)("label",{className:"form__label",htmlFor:"register-email",children:"Email"}),Object(n.jsx)("input",{className:"form__input ".concat(C?"form__input_disabled":""),disabled:!!C,type:"email",id:"register-email",ref:L,placeholder:"Email",required:!0}),m.email?Object(n.jsx)("span",{className:"form__error",children:m.email}):"",Object(n.jsx)("label",{className:"form__label",htmlFor:"register-password",children:"Password"}),Object(n.jsx)("input",{className:"form__input ".concat(C?"form__input_disabled":""),disabled:!!C,type:"password",id:"register-password",ref:A,placeholder:"Password",required:!0}),m.password?Object(n.jsx)("span",{className:"form__error",children:m.password}):"",Object(n.jsx)("label",{className:"form__label",htmlFor:"register-username",children:"Username"}),Object(n.jsx)("input",{className:"form__input ".concat(C?"form__input_disabled":""),disabled:!!C,type:"text",id:"register-username",ref:F,placeholder:"Username",required:!0}),m.username?Object(n.jsx)("span",{className:"form__error",children:m.username}):"",Object(n.jsx)("button",{type:"submit",className:"popup__submit ".concat(m?"":"popup__submit_active"),children:t?"Sign up":"Sign in"})]}),Object(n.jsxs)("p",{className:"popup__swap-form-text",children:["or ",Object(n.jsx)("button",{onClick:J,className:"popup__swap-form-button",children:"Sign in"})]})]}):Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)("h2",{className:"popup__title",children:"Sign in"}),Object(n.jsxs)("form",{onChange:q,onSubmit:U,className:"popup__form popup__form_signin form",children:[Object(n.jsx)("label",{className:"form__label",htmlFor:"register-email",children:"Email"}),Object(n.jsx)("input",{className:"form__input ".concat(C?"form__input_disabled":""),disabled:!!C,type:"email",id:"register-email",ref:L,placeholder:"Email",required:!0}),m.email?Object(n.jsx)("span",{className:"form__error",children:m.email}):"",Object(n.jsx)("label",{className:"form__label",htmlFor:"register-password",children:"Password"}),Object(n.jsx)("input",{className:"form__input ".concat(C?"form__input_disabled":""),disabled:!!C,type:"password",id:"register-password",ref:A,placeholder:"Password",required:!0}),m.password?Object(n.jsx)("span",{className:"form__error",children:m.password}):"",x?Object(n.jsx)("span",{className:"form__error",children:y?"Invalid email or password":"Something went wrong, please try again"}):"",Object(n.jsx)("button",{type:"submit",className:"popup__submit ".concat(m?"":"popup__submit_active"),children:t?"Sign up":"Sign in"})]}),Object(n.jsxs)("p",{className:"popup__swap-form-text",children:["or ",Object(n.jsx)("button",{onClick:J,className:"popup__swap-form-button",children:"Sign up"})]})]}):""})},E=function(e){return Object(n.jsx)("section",{className:"modal ".concat(e.isPopupOpen?"modal_visible":""),children:Object(n.jsx)("div",{className:"popup ".concat(e.isPopupOpen?"popup_visible":""),children:Object(n.jsxs)("div",{className:"form-width",children:[Object(n.jsx)("i",{className:"popup__exit",onClick:function(){e.togglePopup(!1),e.toggleFormPopup(!1)}}),e.children]})})})},U=r(13),H=r(14),D=new(function(){function e(t){var r=t.url,n=t.headers,a=t.credentialPreference;Object(U.a)(this,e),this._url=r,this._headers=n,this._credential=a}return Object(H.a)(e,[{key:"_checkResponse",value:function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}},{key:"register",value:function(e,t,r){var n=this;return fetch("".concat(this._url,"/signup"),{method:"POST",credentials:this._credential,headers:this._headers,body:JSON.stringify({email:e,password:t,name:r})}).then((function(e){return n._checkResponse(e)}))}},{key:"signin",value:function(e,t){var r=this;return fetch("".concat(this._url,"/signin"),{method:"POST",credentials:this._credential,headers:this._headers,body:JSON.stringify({email:e,password:t})}).then((function(e){return r._checkResponse(e)}))}},{key:"signout",value:function(){var e=this;return fetch("".concat(this._url,"/users/logout"),{credentials:this._credential,headers:this._headers}).then((function(t){return e._checkResponse(t)}))}},{key:"getUserInfo",value:function(){var e=this;return fetch("".concat(this._url,"/users/me"),{credentials:this._credential,headers:this._headers}).then((function(t){return e._checkResponse(t)}))}},{key:"getArticles",value:function(){var e=this;return fetch("".concat(this._url,"/articles"),{credentials:this._credential,headers:this._headers}).then((function(t){return e._checkResponse(t)}))}},{key:"addArticle",value:function(e){var t=this;return fetch("".concat(this._url,"/articles"),{credentials:this._credential,method:"POST",headers:this._headers,body:JSON.stringify(e)}).then((function(e){return t._checkResponse(e)}))}},{key:"deleteArticle",value:function(e){var t=this;return fetch("".concat(this._url,"/articles/").concat(e),{credentials:this._credential,method:"DELETE",headers:this._headers}).then((function(e){return t._checkResponse(e)}))}}]),e}())({url:"https://api.danny-news-explorer.students.nomoreparties.site",headers:{"Content-Type":"application/json"},credentialPreference:"include"}),T=r(25),q=function(e){var t=e.component,r=Object(T.a)(e,["component"]);return Object(n.jsx)(b.b,{children:function(){return r.isLoggedIn?Object(n.jsx)(t,Object(R.a)({},r)):Object(n.jsx)(b.a,{to:{pathname:"/",state:{redirected:!0}}})}})},J=new(function(){function e(t){var r=t.url,n=t.endpoint,a=t.auth,s=t.pageSize,c=t.apiKey;Object(U.a)(this,e),this._url=r,this._endpoint=n,this._auth=a,this._pageSize=s,this._apiKey=c}return Object(H.a)(e,[{key:"_checkResponse",value:function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}},{key:"_getFromDate",value:function(){var e=new Date((new Date).setDate((new Date).getDate()-5)),t=e.getUTCMonth()+1,r=e.getUTCDate();return e.getUTCFullYear()+"/"+t+"/"+r}},{key:"_getToDate",value:function(){var e=new Date,t=e.getUTCMonth()+1,r=e.getUTCDate();return e.getUTCFullYear()+"/"+t+"/"+r}},{key:"search",value:function(e){var t=this;return fetch("".concat(this._url).concat(this._endpoint,"?q=").concat(e,"&from=").concat(this._getFromDate(),"&to=").concat(this._getToDate(),"&pageSize=").concat(this._pageSize,"&apiKey=").concat(this._apiKey),{headers:this._auth}).then((function(e){return t._checkResponse(e)}))}}]),e}())(x),z=function(){var e=Object(a.useState)({}),t=Object(p.a)(e,2),r=t[0],s=t[1],c=Object(a.useState)(null),o=Object(p.a)(c,2),i=o[0],l=o[1],g=Object(a.useState)(!1),m=Object(p.a)(g,2),_=m[0],v=m[1],x=Object(a.useState)(!1),w=Object(p.a)(x,2),N=w[0],k=w[1],S=Object(a.useState)(!1),C=Object(p.a)(S,2),R=C[0],L=C[1],U=Object(a.useState)(!1),H=Object(p.a)(U,2),T=H[0],z=H[1],K=Object(a.useState)(!1),V=Object(p.a)(K,2),M=V[0],Y=V[1],B=Object(a.useState)(!1),W=Object(p.a)(B,2),G=W[0],Z=W[1],$=Object(a.useState)(null),Q=Object(p.a)($,2),X=Q[0],ee=Q[1],te=Object(a.useState)(!1),re=Object(p.a)(te,2),ne=re[0],ae=re[1];function se(){v(!1),z(!1),L(!0)}function ce(){v(!0),z(!1),L(!0)}var oe=Object(a.useCallback)((function(){k(!0),L(!0),v(!1),ae(!1)}),[k,L,v,ae]);function ie(){return le.apply(this,arguments)}function le(){return(le=Object(d.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D.getUserInfo();case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ue(e,t,r){return D.register(e,t,r)}function de(e,t){return D.signin(e,t)}function pe(){return localStorage.clear(),D.signout()}function he(){return localStorage.removeItem("articles"),D.getArticles()}function be(e){if(e)return localStorage.removeItem("articles"),D.deleteArticle(e);throw new Error("card ID not submitted")}function je(e){if(e)return D.addArticle(e);throw new Error("No article submitted")}function ge(e){return fe.apply(this,arguments)}function fe(){return(fe=Object(d.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",J.search(t));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(a.useEffect)((function(){localStorage.getItem("token")?ie().then((function(e){if(e)return s(e),ee(!1),void l(!0)})).catch((function(e){if("Error: 401"!==e)return ee(!0),void console.log(e);l(!1),ee(!1)})):(l(!1),ee(!1))}),[]),null===i&&null===X?Object(n.jsx)(P,{}):X?Object(n.jsx)(y,{error:!0}):Object(n.jsx)(j.Provider,{value:r,children:Object(n.jsx)("div",{className:"app",children:Object(n.jsxs)("div",{className:"page",children:[Object(n.jsx)(h.a,{children:Object(n.jsxs)(b.d,{children:[Object(n.jsxs)(b.b,{exact:!0,path:"/",children:[Object(n.jsx)(f,{isLoggedIn:i,toggleLoggedIn:l,isPopupOpen:N,isFormPopupOpen:R,toggleIsRegisterPopup:v,togglePopup:k,toggleFormPopup:L,isSavedNewsRoute:!1,signoutHandler:pe,handlePopup:oe,toggleNav:ae,isNavOpen:ne}),Object(n.jsx)(I,{isLoggedIn:i,isLoading:G,toggleIsLoading:Z,isPopupOpen:N,isFormPopupOpen:R,togglePopup:k,toggleFormPopup:L,getUserArticles:he,addArticleHandler:je,searchHandler:ge,deleteArticleHandler:be,handlePopup:oe}),Object(n.jsx)(O,{})]}),Object(n.jsxs)(b.b,{exact:!0,path:"/saved-news",children:[Object(n.jsx)(f,{isLoggedIn:i,isSavedNewsRoute:!0,isPopupOpen:N,isFormPopupOpen:R,toggleIsRegisterPopup:v,toggleFormPopup:L,togglePopup:k,toggleLoggedIn:l,signoutHandler:pe,handlePopup:oe,toggleNav:ae,isNavOpen:ne}),Object(n.jsx)(q,{component:A,isLoggedIn:i,isLoading:G,toggleIsLoading:Z,toggleFormPopup:L,togglePopup:k,getUserArticles:he,deleteArticleHandler:be,addArticleHandler:je,handlePopup:oe}),Object(n.jsx)(O,{})]}),Object(n.jsx)(b.a,{from:"*",to:"/"})]})}),R?Object(n.jsx)(E,{togglePopup:k,toggleFormPopup:L,isPopupOpen:N,children:Object(n.jsx)(F,{isRegisterPopup:_,toggleIsRegisterPopup:v,isFormPopupOpen:R,toggleFormPopup:L,isRegisterSuccessPopupOpen:T,toggleRegisterSuccessPopup:z,togglePopup:k,toggleLoggedIn:l,isRegisterSuccess:M,toggleRegisterSuccess:Y,setCurrentUser:s,registerHandler:ue,signinHandler:de,getUserInfo:ie})}):"",T?Object(n.jsx)(E,{isPopupOpen:N,togglePopup:k,toggleFormPopup:L,children:M?Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)("h2",{className:"popup__title",children:"Registration completed successfully!"}),Object(n.jsx)("button",{className:"popup__swap-form-text popup__swap-form-button",onClick:se,children:"Sign in"})]}):Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)("h2",{className:"popup__title",children:"Oops! Something went wrong"}),Object(n.jsx)("button",{className:"popup__swap-form-text popup__swap-form-button",onClick:ce,children:"Try again"})]})}):""]})})})};o.a.render(Object(n.jsx)(s.a.StrictMode,{children:Object(n.jsx)(z,{})}),document.getElementById("root")),i()}},[[38,1,2]]]);
//# sourceMappingURL=main.24372c25.chunk.js.map